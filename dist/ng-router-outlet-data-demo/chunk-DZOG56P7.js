import{a as F,b as _,c as N}from"./chunk-ZMAOSPHI.js";import{$ as j,B as I,F as a,I as u,M as d,O as D,Q as v,R as U,S as C,T as S,U as n,V as i,W as f,Z as l,_ as o,aa as p,d as M,f as w,fa as k,g as m,h as y,i as R,j as W,k as b,l as E,o as T,r as c,ta as O,wa as $}from"./chunk-TMBBLDCF.js";function V(e){return{title:e.title,openingCrawl:e.opening_crawl,releaseDate:e.release_date,episodeId:e.episode_id,characters:e.characters}}var h=class e{#e=c(O);retrieveMovie(r){return this.#e.get(r).pipe(m(t=>V(t)),W(t=>(console.error(t),w(void 0))))}retrieveMovies(r){let t=r.map(s=>this.retrieveMovie(s));return y(t).pipe(m(s=>s.filter(P=>typeof P<"u")))}static \u0275fac=function(t){return new(t||e)};static \u0275prov=T({token:e,factory:e.\u0275fac,providedIn:"root"})};function B(e,r){if(e&1&&(n(0,"li"),o(1),i()),e&2){let t=r.$implicit;a(),j(t)}}function H(e,r){if(e&1&&(n(0,"ol"),C(1,B,2,1,"li",null,U),i()),e&2){let t=l();a(),S(t.castResource.value())}}var x=class e{characterUrl=I([]);characterSub=new M;cast$=this.characterSub.pipe(E((r,t)=>[...r,t],[]));castResource=_({loader:()=>this.cast$});charactersService=c(N);constructor(){R(0,500).pipe(m(r=>this.characterUrl()[r]),b(r=>(console.log(`Retrieve character url: ${r}`),this.charactersService.retrieveCharacterNameByUrl(r))),F()).subscribe(r=>{r&&this.characterSub.next(r)})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=u({type:e,selectors:[["app-star-wars-cast"]],inputs:{characterUrl:[1,"characterUrl"]},decls:4,vars:1,template:function(t,s){t&1&&(n(0,"h4"),o(1,"Cast"),i(),d(2,H,3,0,"ol"),f(3,"hr")),t&2&&(a(2),v(s.castResource.hasValue()?2:-1))},styles:["li[_ngcontent-%COMP%]{padding-top:.25rem;padding-bottom:.25rem}"],changeDetection:0})};var q=(e,r)=>r.title;function J(e,r){e&1&&(n(0,"p"),o(1,"Loading movies..."),i())}function z(e,r){if(e&1&&(n(0,"p"),o(1),i()),e&2){let t=l();a(),p("Error: ",t.moviesResource.error(),"")}}function G(e,r){if(e&1&&(n(0,"p"),o(1),i(),n(2,"p"),o(3),i(),n(4,"p"),o(5),i(),n(6,"p"),o(7),i(),f(8,"hr"),k(9),f(10,"app-star-wars-cast",1)),e&2){let t=r.$implicit;a(),p("Title: ",t.title,""),a(2),p("Episode: ",t.episodeId,""),a(2),p("Release Date: ",t.releaseDate,""),a(2),p("Opening Crawl: ",t.openingCrawl,"");let s=t.characters;a(3),D("characterUrl",s)}}function K(e,r){if(e&1&&C(0,G,11,5,null,null,q),e&2){let t=l(2);S(t.moviesResource.value())}}function Q(e,r){if(e&1&&d(0,K,2,0),e&2){let t=l();v(t.moviesResource.hasValue()?0:-1)}}var g=class e{films=c($);movieService=c(h);moviesResource=_({request:()=>this.films(),loader:({request:r})=>this.movieService.retrieveMovies(r),defaultValue:[]});static \u0275fac=function(t){return new(t||e)};static \u0275cmp=u({type:e,selectors:[["app-starwars-movies"]],decls:6,vars:1,consts:[[1,"movies"],[3,"characterUrl"]],template:function(t,s){t&1&&(n(0,"div")(1,"h3",0),o(2,"Movies"),i(),d(3,J,2,0,"p")(4,z,2,1,"p")(5,Q,1,1),i()),t&2&&(a(3),v(s.moviesResource.isLoading()?3:s.moviesResource.error()?4:5))},dependencies:[x],styles:[".movies[_ngcontent-%COMP%]{font-style:italic;text-decoration:underline;margin-bottom:.5rem}"],changeDetection:0})};export{g as default};
